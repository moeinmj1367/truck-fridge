<!DOCTYPE html>
<html dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ú©Ù†ØªØ±Ù„ ÛŒØ®Ú†Ø§Ù„ Ú©Ø§Ù…ÛŒÙˆÙ†</title>
    <style>
        body { font-family: Tahoma; text-align: center; background: #f5f5f5; }
        .container { max-width: 600px; margin: 50px auto; background: white; padding: 20px; border-radius: 10px; }
        .button { padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
        .on { background: green; color: white; }
        .off { background: red; color: white; }
        .status { margin: 20px 0; padding: 10px; background: #e9e9e9; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸšš Ú©Ù†ØªØ±Ù„ ÛŒØ®Ú†Ø§Ù„ Ú©Ø§Ù…ÛŒÙˆÙ†</h1>
        
        <div class="status">
            <h3>ğŸŒ¡ï¸ Ø¯Ù…Ø§ÛŒ ÙØ¹Ù„ÛŒ: <span id="temperature">0</span>Â°C</h3>
        </div>

        <div>
            <h3>âš¡ Ø±Ù„Ù‡ 1 (Ú©Ù…Ù¾Ø±Ø³ÙˆØ±):</h3>
            <button class="button on" onclick="controlRelay(1, true)">Ø±ÙˆØ´Ù†</button>
            <button class="button off" onclick="controlRelay(1, false)">Ø®Ø§Ù…ÙˆØ´</button>
            <span id="relay1Status">Ø®Ø§Ù…ÙˆØ´</span>
        </div>

        <div>
            <h3>âš¡ Ø±Ù„Ù‡ 2 (ÙÙ†â€ŒÙ‡Ø§):</h3>
            <button class="button on" onclick="controlRelay(2, true)">Ø±ÙˆØ´Ù†</button>
            <button class="button off" onclick="controlRelay(2, false)">Ø®Ø§Ù…ÙˆØ´</button>
            <span id="relay2Status">Ø®Ø§Ù…ÙˆØ´</span>
        </div>

        <div style="margin-top: 20px;">
            <button onclick="updateStatus()">Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª</button>
        </div>
    </div>

    <script>
        const API_URL = "https://truck-fridge-api.onrender.com";

        // Ú©Ù†ØªØ±Ù„ Ø±Ù„Ù‡
        async function controlRelay(relayNumber, state) {
            try {
                const response = await fetch(API_URL + '/control', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ relay1: state })
                });
                
                if (response.ok) {
                    alert(`Ø±Ù„Ù‡ ${relayNumber} ${state ? 'Ø±ÙˆØ´Ù†' : 'Ø®Ø§Ù…ÙˆØ´'} Ø´Ø¯`);
                    updateStatus();
                }
            } catch (error) {
                alert('Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ø¯Ø³ØªÙˆØ±');
            }
        }

        // Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¶Ø¹ÛŒØª
        async function updateStatus() {
            try {
                const response = await fetch(API_URL + '/status');
                const data = await response.json();
                
                document.getElementById('temperature').textContent = data.temperature;
                document.getElementById('relay1Status').textContent = data.relay1 ? 'Ø±ÙˆØ´Ù†' : 'Ø®Ø§Ù…ÙˆØ´';
                document.getElementById('relay2Status').textContent = data.relay2 ? 'Ø±ÙˆØ´Ù†' : 'Ø®Ø§Ù…ÙˆØ´';
            } catch (error) {
                alert('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¶Ø¹ÛŒØª');
            }
        }

        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ø± 10 Ø«Ø§Ù†ÛŒÙ‡
        setInterval(updateStatus, 10000);
        
        // Ø§ÙˆÙ„ÛŒÙ† Ø¨Ø§Ø± ÙˆØ¶Ø¹ÛŒØª Ø±Ùˆ Ø¨Ú¯ÛŒØ±
        updateStatus();
    </script>
</body>
</html>
